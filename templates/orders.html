<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Мои заказы - VibesResell</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --tg-theme-bg-color: #ffffff;
            --tg-theme-text-color: #000000;
            --tg-theme-hint-color: #999999;
            --tg-theme-link-color: #3390ec;
            --tg-theme-button-color: #3390ec;
            --tg-theme-button-text-color: #ffffff;
            --tg-theme-secondary-bg-color: #f4f4f5;
        }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; margin: 0; padding: 15px; background-color: var(--tg-theme-bg-color); color: var(--tg-theme-text-color); }
        h1 { margin-bottom: 20px; }
        .order-card {
            background-color: var(--tg-theme-secondary-bg-color);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
        }
        .order-header {
            display: flex;
            justify-content: space-between;
            font-weight: bold;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #e0e0e0;
        }
        .order-status {
            padding: 3px 8px;
            border-radius: 6px;
            font-size: 12px;
            color: white;
            background-color: #95a5a6; /* Серый по умолчанию */
        }
        .order-status.processing { background-color: #f39c12; } /* Обработка */
        .order-status.shipped { background-color: #3498db; }   /* Отправлен */
        .order-status.delivered { background-color: #2ecc71; } /* Доставлен */
        .order-status.cancelled { background-color: #e74c3c; }  /* Отменен */

        .item-list { list-style: none; padding-left: 0; margin-bottom: 10px; }
        .item-list li { color: var(--tg-theme-hint-color); }
        .order-footer { text-align: right; font-weight: bold; }
        .empty-orders { text-align: center; padding: 40px; color: var(--tg-theme-hint-color); }
    </style>
</head>
<body>
    <h1>Мои заказы</h1>

    {% if orders %}
        {% for order in orders %}
        <div class="order-card">
            <div class="order-header">
                <span>Заказ #{{ order.id }} от {{ order.created_at.strftime('%d.%m.%Y') }}</span>
                <span class="order-status
                    {% if order.status == 'Обработка' or order.status == 'Ожидает оплаты' %}processing
                    {% elif order.status == 'Отправлен' %}shipped
                    {% elif order.status == 'Доставлен' %}delivered
                    {% elif order.status == 'Отменен' %}cancelled
                    {% endif %}
                ">{{ order.status }}</span>
            </div>
            <ul class="item-list">
                {% for item in order.items %}
                    <li>{{ item.name }} ({{ item.size }}) x {{ item.quantity }}</li>
                {% endfor %}
            </ul>
            {% if order.track_number %}
            <p><strong>Трек-номер:</strong> {{ order.track_number }}</p>
            {% endif %}
            <div class="order-footer">
                Итого: {{ order.total_amount }} руб.
            </div>
        </div>
        {% endfor %}
    {% else %}
        <div class="empty-orders">
            <p>У вас пока нет заказов.</p>
            <a href="/?user_id={{ user_id }}" style="color: var(--tg-theme-link-color);">Перейти в магазин</a>
        </div>
    {% endif %}

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();
    </script>
</body>
</html>